boost_model <- boost_tree(min_n= tune(), 
                         mtry =tune(), 
                         learn_rate= tune(),
                         mode = "classification") %>%
  set_engine("xgboost")

boost_wflow <-
 workflow() %>%
 add_recipe(recipe) %>% 
 add_model(boost_model)

#parameters
boost_params <- parameters(boost_model) %>%
  update(mtry = mtry(range = c(2, 12)))

#boost grid
boost_grid <- grid_regular(boost_params,
  levels=3
)

boost2_res <- boost_wflow %>%
  tune_grid(
    resamples = koi_fold,
    grid = boost_grid
  )

boost_tune <- boost_wflow %>%
  tune_grid(resamples = koi_folds,
            grid = boost_grid)
tune_grid(boost_model,
          recipe,
          koi_folds,
          boost_grid)

autoplot(boost_tune)

boost_res <- 
  boost_wflow %>% 
  fit_resamples(
    resamples = cv, 
    metrics = metric_set(
      recall, precision, f_meas, 
      accuracy, kap,
      roc_auc, sens, spec),
    control = control_resamples(save_pred = TRUE)
    ) 

boost_res %>% collect_metrics(summarize = TRUE)
